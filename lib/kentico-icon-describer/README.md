# Kentico Icon Describer

This project automates the process of:

1. Extracting Kentico built-in icon names from the official icon list
2. Rendering and screenshotting each icon via a real browser
3. Using OpenAI Vision to generate a short human-readable description per icon
4. Storing the results in an Excel spreadsheet
5. Using that spreadsheet to enrich a C# constants file with XML doc comments

Source of truth for icons:  
<https://devnet.kentico.com/docs/icon-list/index.html>

---

## Prerequisites

- Python 3.9+
- A funded OpenAI API key (Vision support required)
- Playwright Chromium browser

---

## Setup

```bash
python -m venv .venv
source .venv/bin/activate   # Windows: .venv\Scripts\activate

pip install playwright openai openpyxl pillow python-dotenv
python -m playwright install chromium
```

Create a `.env` file:

```env
OPENAI_API_KEY=sk-...
ICON_LIST_URL=https://devnet.kentico.com/docs/icon-list/index.html
OUTPUT_XLSX=kentico-icons.xlsx
```

---

## Script 1 — `icon_describer.py`

### What it does

- Loads the Kentico icon list page in a headless browser
- Extracts valid `icon-*` glyph class names from the DOM
- Renders each icon using the icon font
- Screenshots each icon to `icon_shots/<icon-name>.png`
- Sends each image to OpenAI Vision for a short description
- Writes results to an Excel file:

| dash_cased_name | description |
|-----------------|-------------|
| icon-accordion | Accordion / expandable panels |

### Key behaviors

- **Incremental writes**: the XLSX is saved after every icon
- **Resumable**:
  - Existing PNGs are reused
  - Icons with valid descriptions are skipped
  - Icons with `[ERROR]` are retried
- **Safe exit on quota exhaustion** (no spreadsheet spam)

### Run it

```bash
python icon_describer.py
```

You can stop and restart at any time.

---

## Script 2 — `add_icon_docs.py`

### What it does

- Reads the Excel file generated by `icon_describer.py`
- Scans a C# file containing icon constants, e.g.:

```csharp
public const string ACCORDION = "icon-accordion";
```

- If a matching icon exists in the XLSX, inserts an XML doc comment:

```csharp
/// <summary>
/// Accordion / expandable panels
/// </summary>
public const string ACCORDION = "icon-accordion";
```

### Important details

- Existing XML doc comments are **not duplicated**
- `#pragma` directives are preserved and handled correctly
- Only icons with real descriptions (not `[ERROR]`) are used
- Descriptions are XML-escaped automatically

### Run it

Generate a new file:

```bash
python add_icon_docs.py \
  --cs KenticoIcons.cs \
  --xlsx kentico-icons.xlsx \
  --out KenticoIcons.withdocs.cs
```

Or modify in place:

```bash
python add_icon_docs.py \
  --cs KenticoIcons.cs \
  --xlsx kentico-icons.xlsx \
  --inplace
```

---

## Output Summary

- `icon_shots/`  
  PNG screenshots of each rendered icon

- `kentico-icons.xlsx`  
  Icon name → AI-generated description mapping

- `KenticoIcons.cs`  
  (optionally) enriched with XML documentation

---

## Why this exists

Kentico exposes a large set of built-in icons, but the icon names alone aren’t descriptive.  
This workflow creates a maintainable, human-readable mapping that improves:

- IntelliSense
- Discoverability
- Component registration ergonomics
